<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Introduction to linear models in R | Intro to R for Forest Ecosystem Science</title>
  <meta name="description" content="Introductory R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Introduction to linear models in R | Intro to R for Forest Ecosystem Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introductory R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Introduction to linear models in R | Intro to R for Forest Ecosystem Science" />
  
  <meta name="twitter:description" content="Introductory R" />
  

<meta name="author" content="Anu Singh, Benjamin Wagner, and Kaitlyn Hammond" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-data-visualization-in-ggplot2.html"/>
<link rel="next" href="functions-in-r.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>1.1</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html"><a href="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html"><i class="fa fa-check"></i><b>2</b> A few words on a productive setup and workflow in <code>R</code> with <em>R-Studio</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html"><a href="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html#r-projects"><i class="fa fa-check"></i><b>2.1</b> R Projects</a></li>
<li class="chapter" data-level="2.2" data-path="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html"><a href="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html#setting-up-the-r-studio-user-interface"><i class="fa fa-check"></i><b>2.2</b> Setting up the R-Studio User interface</a></li>
<li class="chapter" data-level="2.3" data-path="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html"><a href="a-few-words-on-a-productive-setup-and-workflow-in-r-with-r-studio.html#code-folds-and-commenting"><i class="fa fa-check"></i><b>2.3</b> Code folds and commenting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html"><i class="fa fa-check"></i><b>3</b> Introducing the koala dataset</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#data-types-and-variable-types"><i class="fa fa-check"></i><b>3.1</b> <em>data types</em> and <em>variable types</em></a></li>
<li class="chapter" data-level="3.2" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#changing-variable-types"><i class="fa fa-check"></i><b>3.2</b> Changing <em>variable types</em></a></li>
<li class="chapter" data-level="3.3" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#how-the-koala-dataset-was-collated"><i class="fa fa-check"></i><b>3.3</b> How the koala dataset was collated</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#loading-the-raw-data"><i class="fa fa-check"></i><b>3.3.1</b> Loading the raw data</a></li>
<li class="chapter" data-level="3.3.2" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#adding-the-state-names-by-location"><i class="fa fa-check"></i><b>3.3.2</b> Adding the state names by location</a></li>
<li class="chapter" data-level="3.3.3" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#creating-dummy-data"><i class="fa fa-check"></i><b>3.3.3</b> Creating dummy data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><i class="fa fa-check"></i><b>4</b> <code>dplyr</code> - A brief introduction to tidy data manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#loading-and-checking-the-data"><i class="fa fa-check"></i><b>4.1</b> Loading and checking the data</a></li>
<li class="chapter" data-level="4.2" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#working-with-dplyr"><i class="fa fa-check"></i><b>4.2</b> Working with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#select-and-dplyrs-pipe"><i class="fa fa-check"></i><b>4.2.1</b> select() and dplyr’s pipe</a></li>
<li class="chapter" data-level="4.2.2" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#filter"><i class="fa fa-check"></i><b>4.2.2</b> filter()</a></li>
<li class="chapter" data-level="4.2.3" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1"><i class="fa fa-check"></i><b>4.2.3</b> Challenge 1</a></li>
<li class="chapter" data-level="4.2.4" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#group_by-and-summarise"><i class="fa fa-check"></i><b>4.2.4</b> group_by() and summarise()</a></li>
<li class="chapter" data-level="4.2.5" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2"><i class="fa fa-check"></i><b>4.2.5</b> Challenge 2</a></li>
<li class="chapter" data-level="4.2.6" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#mutate"><i class="fa fa-check"></i><b>4.2.6</b> mutate()</a></li>
<li class="chapter" data-level="4.2.7" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-3"><i class="fa fa-check"></i><b>4.2.7</b> Challenge 3</a></li>
<li class="chapter" data-level="4.2.8" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#pivoting"><i class="fa fa-check"></i><b>4.2.8</b> Pivoting</a></li>
<li class="chapter" data-level="4.2.9" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-4"><i class="fa fa-check"></i><b>4.2.9</b> Challenge 4</a></li>
<li class="chapter" data-level="4.2.10" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-5"><i class="fa fa-check"></i><b>4.2.10</b> Challenge 5</a></li>
<li class="chapter" data-level="4.2.11" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#solution-to-all-challenges"><i class="fa fa-check"></i><b>4.2.11</b> Solution to all challenges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html"><i class="fa fa-check"></i><b>5</b> Introduction to data visualization in <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#general-information-about-ggplot"><i class="fa fa-check"></i><b>5.1</b> General information about <strong>GGPLOT</strong></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#package-needed-for-the-analysis"><i class="fa fa-check"></i><b>5.1.1</b> Package needed for the analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#be-patient-with-r-and-yourself-its-not-magic-but-rather-work"><i class="fa fa-check"></i><b>5.1.2</b> Be Patient with R and yourself, its not magic but rather work</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#make-your-first-graph"><i class="fa fa-check"></i><b>5.2</b> Make your first Graph</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#geom_point"><i class="fa fa-check"></i><b>5.3</b> <code>geom_point</code></a></li>
<li class="chapter" data-level="5.4" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1"><i class="fa fa-check"></i><b>5.4</b> Challenge 1</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#geom_boxplot"><i class="fa fa-check"></i><b>5.4.1</b> <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#facet_wrap"><i class="fa fa-check"></i><b>5.4.2</b> <code>facet_wrap</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#reverse-the-condition-logic"><i class="fa fa-check"></i><b>5.4.3</b> Reverse the condition logic</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#challenge2"><i class="fa fa-check"></i><b>5.5</b> Challenge2</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-data-visualization-in-ggplot2.html"><a href="introduction-to-data-visualization-in-ggplot2.html#challenge3"><i class="fa fa-check"></i><b>5.6</b> Challenge3</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html"><i class="fa fa-check"></i><b>6</b> Introduction to linear models in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#model-assumptions"><i class="fa fa-check"></i><b>6.1</b> Model Assumptions</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#linear-model"><i class="fa fa-check"></i><b>6.2</b> Linear model</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#correlation"><i class="fa fa-check"></i><b>6.3</b> Correlation</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#statistical-hypothesis"><i class="fa fa-check"></i><b>6.4</b> Statistical Hypothesis</a></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#anova"><i class="fa fa-check"></i><b>6.5</b> ANOVA</a></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#build-the-model"><i class="fa fa-check"></i><b>6.6</b> <strong>Build the model </strong></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#glm"><i class="fa fa-check"></i><b>6.6.1</b> GLM</a></li>
<li class="chapter" data-level="6.6.2" data-path="introduction-to-linear-models-in-r.html"><a href="introduction-to-linear-models-in-r.html#but-there-are-some-limitations-of-glms-too-such-as"><i class="fa fa-check"></i><b>6.6.2</b> But there are some limitations of GLMs too, such as,</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions-in-r.html"><a href="functions-in-r.html"><i class="fa fa-check"></i><b>7</b> Functions in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functions-in-r.html"><a href="functions-in-r.html#mathematical-operations"><i class="fa fa-check"></i><b>7.1.1</b> Mathematical operations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functions-in-r.html"><a href="functions-in-r.html#what-is-an-r-function"><i class="fa fa-check"></i><b>7.2</b> What is an R function?</a></li>
<li class="chapter" data-level="7.3" data-path="functions-in-r.html"><a href="functions-in-r.html#nesting-functions"><i class="fa fa-check"></i><b>7.3</b> Nesting functions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functions-in-r.html"><a href="functions-in-r.html#some-basic-built-in-mathematical-functions"><i class="fa fa-check"></i><b>7.3.1</b> Some basic built-in mathematical functions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functions-in-r.html"><a href="functions-in-r.html#assigning-variables-within-functions"><i class="fa fa-check"></i><b>7.4</b> Assigning variables within functions</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1"><i class="fa fa-check"></i><b>7.4.1</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functions-in-r.html"><a href="functions-in-r.html#using-return"><i class="fa fa-check"></i><b>7.5</b> Using <code>return()</code></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2"><i class="fa fa-check"></i><b>7.5.1</b> Challenge 2</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functions-in-r.html"><a href="functions-in-r.html#solutions-to-challenges"><i class="fa fa-check"></i><b>7.6</b> Solutions to challenges</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1-1"><i class="fa fa-check"></i><b>7.6.1</b> Challenge 1</a></li>
<li class="chapter" data-level="7.6.2" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2-1"><i class="fa fa-check"></i><b>7.6.2</b> Challenge 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="loops-and-apply.html"><a href="loops-and-apply.html"><i class="fa fa-check"></i><b>8</b> Loops and <code>apply</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="loops-and-apply.html"><a href="loops-and-apply.html#so-what-do-you-want-to-repeat"><i class="fa fa-check"></i><b>8.2</b> So, what do you want to repeat?</a></li>
<li class="chapter" data-level="8.3" data-path="loops-and-apply.html"><a href="loops-and-apply.html#dont-use-a-loop-when-you-can-use-apply"><i class="fa fa-check"></i><b>8.3</b> DON’T USE A LOOP WHEN YOU CAN USE APPLY!</a></li>
<li class="chapter" data-level="8.4" data-path="loops-and-apply.html"><a href="loops-and-apply.html#the-apply-family"><i class="fa fa-check"></i><b>8.4</b> The <code>apply</code> family</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="loops-and-apply.html"><a href="loops-and-apply.html#sapply"><i class="fa fa-check"></i><b>8.4.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="8.4.2" data-path="loops-and-apply.html"><a href="loops-and-apply.html#lapply"><i class="fa fa-check"></i><b>8.4.2</b> <code>lapply</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="loops-and-apply.html"><a href="loops-and-apply.html#for-loops"><i class="fa fa-check"></i><b>8.5</b> <code>for</code> loops</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="loops-and-apply.html"><a href="loops-and-apply.html#some-for-loop-hints"><i class="fa fa-check"></i><b>8.5.1</b> Some <code>for</code> loop hints</a></li>
<li class="chapter" data-level="8.5.2" data-path="loops-and-apply.html"><a href="loops-and-apply.html#challenge"><i class="fa fa-check"></i><b>8.5.2</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="loops-and-apply.html"><a href="loops-and-apply.html#solutions-to-challenge"><i class="fa fa-check"></i><b>8.6</b> Solutions to challenge</a></li>
<li class="chapter" data-level="8.7" data-path="loops-and-apply.html"><a href="loops-and-apply.html#bonus-changing-plot-labels"><i class="fa fa-check"></i><b>8.7</b> Bonus: Changing plot labels</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html"><i class="fa fa-check"></i><b>9</b> Working with spatial data in <code>R</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#transforming-a-dataset-into-an-sf-object"><i class="fa fa-check"></i><b>9.1</b> Transforming a dataset into an <code>sf</code> object</a></li>
<li class="chapter" data-level="9.2" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#loading-shapefiles-into-r-transforming-and-plotting"><i class="fa fa-check"></i><b>9.2</b> Loading shapefiles into <code>R</code>, transforming and plotting</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1"><i class="fa fa-check"></i><b>9.2.1</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#simple-geometric-operations"><i class="fa fa-check"></i><b>9.3</b> Simple geometric operations</a></li>
<li class="chapter" data-level="9.4" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#making-a-map-using-ggplot2"><i class="fa fa-check"></i><b>9.4</b> Making a map using <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2"><i class="fa fa-check"></i><b>9.4.1</b> Challenge 2</a></li>
<li class="chapter" data-level="9.4.2" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#pimping-up-you-map"><i class="fa fa-check"></i><b>9.4.2</b> Pimping up you map</a></li>
<li class="chapter" data-level="9.4.3" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-4"><i class="fa fa-check"></i><b>9.4.3</b> Challenge 4</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#some-r-raster-basics"><i class="fa fa-check"></i><b>9.5</b> Some <code>R</code> raster basics</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#croppingmasking"><i class="fa fa-check"></i><b>9.5.1</b> Cropping/Masking</a></li>
<li class="chapter" data-level="9.5.2" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#plotting-and-extracting-data"><i class="fa fa-check"></i><b>9.5.2</b> Plotting and extracting data</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#plotting-rasters-in-ggplot2"><i class="fa fa-check"></i><b>9.6</b> Plotting rasters in <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-4-1"><i class="fa fa-check"></i><b>9.6.1</b> Challenge 4</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#solutions-to-all-challenges"><i class="fa fa-check"></i><b>9.7</b> Solutions to all Challenges</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1-1"><i class="fa fa-check"></i><b>9.7.1</b> Challenge 1</a></li>
<li class="chapter" data-level="9.7.2" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2-1"><i class="fa fa-check"></i><b>9.7.2</b> Challenge 2</a></li>
<li class="chapter" data-level="9.7.3" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-3"><i class="fa fa-check"></i><b>9.7.3</b> Challenge 3</a></li>
<li class="chapter" data-level="9.7.4" data-path="working-with-spatial-data-in-r.html"><a href="working-with-spatial-data-in-r.html#challenge-4-2"><i class="fa fa-check"></i><b>9.7.4</b> Challenge 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html"><i class="fa fa-check"></i><b>10</b> Spatial tools for forestry and ecological applications</a>
<ul>
<li class="chapter" data-level="10.1" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#an-introduction-to-processing-lidar-data-in-r"><i class="fa fa-check"></i><b>10.1</b> An introduction to processing LiDAR data in <code>R</code></a></li>
<li class="chapter" data-level="10.2" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#working-with-lidar-data-in-r"><i class="fa fa-check"></i><b>10.2</b> Working with LiDAR data in R</a></li>
<li class="chapter" data-level="10.3" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#step-1.-loading-and-visualizing-pointclouds"><i class="fa fa-check"></i><b>10.3</b> Step 1. Loading and visualizing pointclouds</a></li>
<li class="chapter" data-level="10.4" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#step-2.-computing-a-canopy-height-model"><i class="fa fa-check"></i><b>10.4</b> Step 2. Computing a canopy height model</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#ground-detection-and-normalizing-a-point-cloud"><i class="fa fa-check"></i><b>10.4.1</b> Ground detection and normalizing a point cloud</a></li>
<li class="chapter" data-level="10.4.2" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#building-the-initial-chm"><i class="fa fa-check"></i><b>10.4.2</b> Building the initial CHM</a></li>
<li class="chapter" data-level="10.4.3" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1"><i class="fa fa-check"></i><b>10.4.3</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#step-3.-individual-tree-segmentation"><i class="fa fa-check"></i><b>10.5</b> Step 3. Individual tree segmentation</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#delineating-the-crowns"><i class="fa fa-check"></i><b>10.5.1</b> Delineating the crowns</a></li>
<li class="chapter" data-level="10.5.2" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2"><i class="fa fa-check"></i><b>10.5.2</b> Challenge 2</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#additional-analysis-computing-a-digital-terrain-model-dtm"><i class="fa fa-check"></i><b>10.6</b> Additional analysis: Computing a digital terrain model (DTM)</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-3"><i class="fa fa-check"></i><b>10.6.1</b> Challenge 3</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#wrapping-up"><i class="fa fa-check"></i><b>10.7</b> Wrapping up</a></li>
<li class="chapter" data-level="10.8" data-path="spatial-tools-for-forestry-and-ecological-applications.html"><a href="spatial-tools-for-forestry-and-ecological-applications.html#solutions-to-the-challenges"><i class="fa fa-check"></i><b>10.8</b> Solutions to the challenges</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-1-1"><i class="fa fa-check"></i><b>10.8.1</b> Challenge 1</a></li>
<li class="chapter" data-level="10.8.2" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-2-1"><i class="fa fa-check"></i><b>10.8.2</b> Challenge 2</a></li>
<li class="chapter" data-level="10.8.3" data-path="dplyr-a-brief-introduction-to-tidy-data-manipulation.html"><a href="dplyr-a-brief-introduction-to-tidy-data-manipulation.html#challenge-3-1"><i class="fa fa-check"></i><b>10.8.3</b> Challenge 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><a href="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><i class="fa fa-check"></i><b>11</b> Extracting raster fractions and area using a polygon mask</a>
<ul>
<li class="chapter" data-level="11.1" data-path="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><a href="extracting-raster-fractions-and-area-using-a-polygon-mask.html#problem-statement"><i class="fa fa-check"></i><b>11.1</b> Problem statement</a></li>
<li class="chapter" data-level="11.2" data-path="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><a href="extracting-raster-fractions-and-area-using-a-polygon-mask.html#creating-some-dummy-raster-data"><i class="fa fa-check"></i><b>11.2</b> Creating some dummy raster data</a></li>
<li class="chapter" data-level="11.3" data-path="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><a href="extracting-raster-fractions-and-area-using-a-polygon-mask.html#create-some-reserves"><i class="fa fa-check"></i><b>11.3</b> Create some reserves</a></li>
<li class="chapter" data-level="11.4" data-path="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><a href="extracting-raster-fractions-and-area-using-a-polygon-mask.html#extracting-data"><i class="fa fa-check"></i><b>11.4</b> Extracting data</a></li>
<li class="chapter" data-level="11.5" data-path="extracting-raster-fractions-and-area-using-a-polygon-mask.html"><a href="extracting-raster-fractions-and-area-using-a-polygon-mask.html#plotting-the-results"><i class="fa fa-check"></i><b>11.5</b> Plotting the results</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="calculating-class-area-from-raster.html"><a href="calculating-class-area-from-raster.html"><i class="fa fa-check"></i><b>12</b> Calculating class area from raster</a>
<ul>
<li class="chapter" data-level="12.1" data-path="calculating-class-area-from-raster.html"><a href="calculating-class-area-from-raster.html#simple-area-and-area-fraction-calculations-on-a-classified-raster"><i class="fa fa-check"></i><b>12.1</b> Simple area and area fraction calculations on a classified raster</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="introducing-the-koala-dataset.html"><a href="introducing-the-koala-dataset.html#creating-dummy-data"><i class="fa fa-check"></i><b>12.1.1</b> Creating dummy data</a></li>
<li class="chapter" data-level="12.1.2" data-path="calculating-class-area-from-raster.html"><a href="calculating-class-area-from-raster.html#preparing-the-raster-for-area-calculation"><i class="fa fa-check"></i><b>12.1.2</b> Preparing the raster for area calculation</a></li>
<li class="chapter" data-level="12.1.3" data-path="calculating-class-area-from-raster.html"><a href="calculating-class-area-from-raster.html#compiling-a-comprehensive-table"><i class="fa fa-check"></i><b>12.1.3</b> Compiling a comprehensive table</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to R for Forest Ecosystem Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-linear-models-in-r" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Introduction to linear models in R</h1>
<p>Let’s first load packages and data:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="introduction-to-linear-models-in-r.html#cb164-1" aria-hidden="true"></a><span class="kw">library</span>(performance)</span>
<span id="cb164-2"><a href="introduction-to-linear-models-in-r.html#cb164-2" aria-hidden="true"></a><span class="kw">library</span>(corrplot)</span>
<span id="cb164-3"><a href="introduction-to-linear-models-in-r.html#cb164-3" aria-hidden="true"></a><span class="kw">library</span>(emojifont)</span>
<span id="cb164-4"><a href="introduction-to-linear-models-in-r.html#cb164-4" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="introduction-to-linear-models-in-r.html#cb165-1" aria-hidden="true"></a>koala&lt;-<span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;data/koala.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> T)</span>
<span id="cb165-2"><a href="introduction-to-linear-models-in-r.html#cb165-2" aria-hidden="true"></a></span>
<span id="cb165-3"><a href="introduction-to-linear-models-in-r.html#cb165-3" aria-hidden="true"></a><span class="co">#have a peek at the data structure</span></span>
<span id="cb165-4"><a href="introduction-to-linear-models-in-r.html#cb165-4" aria-hidden="true"></a></span>
<span id="cb165-5"><a href="introduction-to-linear-models-in-r.html#cb165-5" aria-hidden="true"></a><span class="kw">str</span>(koala)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	242 obs. of  15 variables:
##  $ species: Factor w/ 1 level &quot;Phascolarctos cinereus&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ X      : num  153 148 153 153 153 ...
##  $ Y      : num  -27.5 -22.5 -27.5 -27.5 -27.5 ...
##  $ state  : Factor w/ 4 levels &quot;New South Wales&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ region : Factor w/ 2 levels &quot;northern&quot;,&quot;southern&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ sex    : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 2 2 1 2 2 2 1 1 ...
##  $ weight : num  7.12 5.45 6.63 6.47 5.62 ...
##  $ size   : num  70.8 70.4 68.7 73 65.2 ...
##  $ fur    : num  1.86 1.85 2.48 1.92 1.95 ...
##  $ tail   : num  1.17 1.56 1.06 1.8 1.63 ...
##  $ age    : int  8 10 1 1 10 12 9 1 1 1 ...
##  $ color  : Factor w/ 6 levels &quot;chocolate brown&quot;,..: 3 4 6 3 4 4 6 4 3 3 ...
##  $ joey   : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 2 1 1 1 1 1 1 1 1 ...
##  $ behav  : Factor w/ 3 levels &quot;Feeding&quot;,&quot;Just Chillin&quot;,..: 3 3 2 3 3 1 2 3 1 3 ...
##  $ obs    : Factor w/ 3 levels &quot;Opportunistic&quot;,..: 2 1 2 3 3 1 3 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="introduction-to-linear-models-in-r.html#cb167-1" aria-hidden="true"></a><span class="kw">summary</span>(koala)</span></code></pre></div>
<pre><code>##                    species          X               Y         
##  Phascolarctos cinereus:242   Min.   :138.6   Min.   :-39.00  
##                               1st Qu.:150.0   1st Qu.:-34.49  
##                               Median :152.0   Median :-32.67  
##                               Mean   :150.3   Mean   :-32.36  
##                               3rd Qu.:152.9   3rd Qu.:-30.31  
##                               Max.   :153.6   Max.   :-21.39  
##              state          region        sex          weight      
##  New South Wales:181   northern:165   female:127   Min.   : 5.406  
##  Queensland     : 16   southern: 77   male  :115   1st Qu.: 6.574  
##  South Australia: 14                               Median : 7.277  
##  Victoria       : 31                               Mean   : 7.923  
##                                                    3rd Qu.: 8.765  
##                                                    Max.   :17.889  
##       size            fur             tail            age       
##  Min.   :64.81   Min.   :1.110   Min.   :1.004   Min.   : 1.00  
##  1st Qu.:68.43   1st Qu.:2.410   1st Qu.:1.272   1st Qu.: 3.00  
##  Median :70.27   Median :2.797   Median :1.534   Median : 7.00  
##  Mean   :70.94   Mean   :2.896   Mean   :1.507   Mean   : 6.43  
##  3rd Qu.:72.33   3rd Qu.:3.217   3rd Qu.:1.750   3rd Qu.: 9.00  
##  Max.   :81.91   Max.   :5.876   Max.   :1.981   Max.   :12.00  
##              color     joey              behav                obs    
##  chocolate brown:21   No :185   Feeding     : 48   Opportunistic:65  
##  dark grey      :36   Yes: 57   Just Chillin: 67   Spotlighting :94  
##  grey           :69             Sleeping    :127   Stagwatching :83  
##  grey-brown     :53                                                  
##  light brown    :20                                                  
##  light grey     :43</code></pre>
<p>The main object of this session is to show how to perform basic regression
analysis, including plots for model checking and display of confidence
and prediction intervals.</p>
<p>linear regression model is represented as:
<span class="math display">\[Y=a+bX\]</span></p>
<p>X is the explanatory variable and Y is the dependent variable. The slope of the line is b, and a is the intercept (the value of y when x = 0).</p>
<p><span class="math display">\[Y  = \sigma + \beta X_1 +  \epsilon \]</span></p>
<p>The parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> , and <span class="math inline">\(\epsilon\)</span> can be estimated using the method of least squares.</p>
<div id="model-assumptions" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Model Assumptions</h2>
<p>Each of the model assumptions concerns the error term of the regression model. These are:</p>
<ol style="list-style-type: decimal">
<li>Individual observations are independent</li>
<li>Response data are normally distributed</li>
<li>Variance is homogeneous across range of predictor</li>
<li>Data are linear</li>
</ol>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="introduction-to-linear-models-in-r.html#cb169-1" aria-hidden="true"></a>koala&lt;-<span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;data/koala.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> T)</span>
<span id="cb169-2"><a href="introduction-to-linear-models-in-r.html#cb169-2" aria-hidden="true"></a></span>
<span id="cb169-3"><a href="introduction-to-linear-models-in-r.html#cb169-3" aria-hidden="true"></a><span class="kw">qplot</span>(koala<span class="op">$</span>weight)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="introduction-to-linear-models-in-r.html#cb171-1" aria-hidden="true"></a><span class="kw">qplot</span>(<span class="kw">log</span>(koala<span class="op">$</span>weight))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="introduction-to-linear-models-in-r.html#cb173-1" aria-hidden="true"></a><span class="kw">qqnorm</span>(koala<span class="op">$</span>weight)</span>
<span id="cb173-2"><a href="introduction-to-linear-models-in-r.html#cb173-2" aria-hidden="true"></a><span class="kw">qqline</span>(koala<span class="op">$</span>weight)<span class="co">### look at the line for the pattern</span></span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="introduction-to-linear-models-in-r.html#cb174-1" aria-hidden="true"></a><span class="co">### qqplot with log transformed data</span></span>
<span id="cb174-2"><a href="introduction-to-linear-models-in-r.html#cb174-2" aria-hidden="true"></a><span class="kw">qqnorm</span>(<span class="kw">log</span>(koala<span class="op">$</span>weight))</span>
<span id="cb174-3"><a href="introduction-to-linear-models-in-r.html#cb174-3" aria-hidden="true"></a><span class="kw">qqline</span>(<span class="kw">log</span>(koala<span class="op">$</span>weight))</span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="introduction-to-linear-models-in-r.html#cb175-1" aria-hidden="true"></a><span class="kw">qplot</span>(<span class="kw">log</span>(koala<span class="op">$</span>weight))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-3-5.png" width="672" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="introduction-to-linear-models-in-r.html#cb177-1" aria-hidden="true"></a><span class="kw">qplot</span>(koala<span class="op">$</span>fur)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-3-6.png" width="672" /></p>
</div>
<div id="linear-model" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Linear model</h2>
<p>The <code>lm</code> function handles much more complicated models than simple linear
regression. There can be many other things besides a dependent and a
descriptive variable in a model formula.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="introduction-to-linear-models-in-r.html#cb179-1" aria-hidden="true"></a>lm&lt;-<span class="kw">lm</span>(size<span class="op">~</span>fur, <span class="dt">data=</span>koala)</span>
<span id="cb179-2"><a href="introduction-to-linear-models-in-r.html#cb179-2" aria-hidden="true"></a><span class="kw">summary</span>(lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = size ~ fur, data = koala)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.1884 -2.3545 -0.2146  1.8404 10.1324 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   63.266      0.853  74.168   &lt;2e-16 ***
## fur            2.650      0.285   9.295   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.346 on 240 degrees of freedom
## Multiple R-squared:  0.2647,	Adjusted R-squared:  0.2616 
## F-statistic:  86.4 on 1 and 240 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="introduction-to-linear-models-in-r.html#cb181-1" aria-hidden="true"></a><span class="kw">confint</span>(lm)</span></code></pre></div>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) 61.585132 64.945776
## fur          2.088061  3.211097</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="introduction-to-linear-models-in-r.html#cb183-1" aria-hidden="true"></a><span class="kw">check_model</span>(lm, <span class="dt">check=</span><span class="kw">c</span>(<span class="st">&quot;qq&quot;</span>, <span class="st">&quot;normality&quot;</span>, <span class="st">&quot;ncv&quot;</span>, <span class="st">&quot;outliers&quot;</span>))</span></code></pre></div>
<pre><code>## Not enough model terms in the conditional part of the model to check for multicollinearity.</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="correlation" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Correlation</h2>
<p>A <strong>Correlation</strong> coefficient is a symmetric, scale-invariant measure of association between two random variables. It ranges from -1 to +1, where the extremes indicate perfect correlation and 0 means no correlation. The sign is negative when large values of one variable are associated with small values of the other and positive if both variables tend to be large or small simultaneously. The reader should be warned that there are many incorrect uses of correlation coefficients, particularly when they are used in regression type settings.</p>
<p>Correlation is a statistical technique that can show whether and how strongly pairs of variables are related.The main result of a correlation is called the correlation coefficient (or “r”). It ranges from -1.0 to +1.0. The closer r is to +1 or -1, the more closely the two variables are related.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="introduction-to-linear-models-in-r.html#cb187-1" aria-hidden="true"></a>corkoala&lt;-koala <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb187-2"><a href="introduction-to-linear-models-in-r.html#cb187-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">select_if</span>(is.numeric)<span class="op">%&gt;%</span></span>
<span id="cb187-3"><a href="introduction-to-linear-models-in-r.html#cb187-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb187-4"><a href="introduction-to-linear-models-in-r.html#cb187-4" aria-hidden="true"></a></span>
<span id="cb187-5"><a href="introduction-to-linear-models-in-r.html#cb187-5" aria-hidden="true"></a>corMat&lt;-<span class="kw">cor</span>(corkoala, <span class="dt">use=</span><span class="st">&quot;complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb187-6"><a href="introduction-to-linear-models-in-r.html#cb187-6" aria-hidden="true"></a></span>
<span id="cb187-7"><a href="introduction-to-linear-models-in-r.html#cb187-7" aria-hidden="true"></a><span class="kw">corrplot</span>(corMat, </span>
<span id="cb187-8"><a href="introduction-to-linear-models-in-r.html#cb187-8" aria-hidden="true"></a>         <span class="dt">method=</span><span class="st">&quot;shade&quot;</span>,</span>
<span id="cb187-9"><a href="introduction-to-linear-models-in-r.html#cb187-9" aria-hidden="true"></a>         <span class="dt">type=</span><span class="st">&quot;lower&quot;</span>,</span>
<span id="cb187-10"><a href="introduction-to-linear-models-in-r.html#cb187-10" aria-hidden="true"></a>         <span class="dt">diag =</span> <span class="ot">FALSE</span>,</span>
<span id="cb187-11"><a href="introduction-to-linear-models-in-r.html#cb187-11" aria-hidden="true"></a>         <span class="dt">addCoef.col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="statistical-hypothesis" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Statistical Hypothesis</h2>
<p>Determine if two or more samples are from the same population<br />
H0:<br />
-Sample means are all equal(i.e., A= )<br />
-There is no effect of the factor on the response variable<br />
If reject H0<br />
-Suggests that at least one sample mean is different from the others<br />
If don’t reject H0<br />
-No evidence that any of the sample means are different from the overall population mean</p>
</div>
<div id="anova" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> ANOVA</h2>
<p>Test for significant differences between the group means can be
performed by comparing two variance estimates. This is why the procedure
is called analysis of variance even though the objective is to compare
the group means.There are multiple ways of representing the effect of a factor variable in linear models (and one-way analysis of variance is the simplest example of a linear model with a factor variable).</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="introduction-to-linear-models-in-r.html#cb188-1" aria-hidden="true"></a><span class="kw">summary</span>(koala)</span></code></pre></div>
<pre><code>##                    species          X               Y         
##  Phascolarctos cinereus:242   Min.   :138.6   Min.   :-39.00  
##                               1st Qu.:150.0   1st Qu.:-34.49  
##                               Median :152.0   Median :-32.67  
##                               Mean   :150.3   Mean   :-32.36  
##                               3rd Qu.:152.9   3rd Qu.:-30.31  
##                               Max.   :153.6   Max.   :-21.39  
##              state          region        sex          weight      
##  New South Wales:181   northern:165   female:127   Min.   : 5.406  
##  Queensland     : 16   southern: 77   male  :115   1st Qu.: 6.574  
##  South Australia: 14                               Median : 7.277  
##  Victoria       : 31                               Mean   : 7.923  
##                                                    3rd Qu.: 8.765  
##                                                    Max.   :17.889  
##       size            fur             tail            age       
##  Min.   :64.81   Min.   :1.110   Min.   :1.004   Min.   : 1.00  
##  1st Qu.:68.43   1st Qu.:2.410   1st Qu.:1.272   1st Qu.: 3.00  
##  Median :70.27   Median :2.797   Median :1.534   Median : 7.00  
##  Mean   :70.94   Mean   :2.896   Mean   :1.507   Mean   : 6.43  
##  3rd Qu.:72.33   3rd Qu.:3.217   3rd Qu.:1.750   3rd Qu.: 9.00  
##  Max.   :81.91   Max.   :5.876   Max.   :1.981   Max.   :12.00  
##              color     joey              behav                obs    
##  chocolate brown:21   No :185   Feeding     : 48   Opportunistic:65  
##  dark grey      :36   Yes: 57   Just Chillin: 67   Spotlighting :94  
##  grey           :69             Sleeping    :127   Stagwatching :83  
##  grey-brown     :53                                                  
##  light brown    :20                                                  
##  light grey     :43</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="introduction-to-linear-models-in-r.html#cb190-1" aria-hidden="true"></a>anova&lt;-<span class="kw">aov</span>(weight<span class="op">~</span>sex, koala)</span>
<span id="cb190-2"><a href="introduction-to-linear-models-in-r.html#cb190-2" aria-hidden="true"></a><span class="kw">summary</span>(anova)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## sex           1  418.9   418.9   147.4 &lt;2e-16 ***
## Residuals   240  681.9     2.8                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="introduction-to-linear-models-in-r.html#cb192-1" aria-hidden="true"></a>anova1&lt;-<span class="kw">aov</span>(tail<span class="op">~</span>sex, koala)</span>
<span id="cb192-2"><a href="introduction-to-linear-models-in-r.html#cb192-2" aria-hidden="true"></a><span class="kw">summary</span>(anova1)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## sex           1   0.01 0.01047   0.133  0.716
## Residuals   240  18.90 0.07876</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="introduction-to-linear-models-in-r.html#cb194-1" aria-hidden="true"></a><span class="kw">TukeyHSD</span>(anova1)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = tail ~ sex, data = koala)
## 
## $sex
##                  diff        lwr        upr     p adj
## male-female 0.0131722 -0.0579901 0.08433451 0.7157089</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="introduction-to-linear-models-in-r.html#cb196-1" aria-hidden="true"></a><span class="kw">anova</span>(anova, anova1, <span class="dt">test=</span><span class="st">&quot;chi&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: weight
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## sex         1 418.89  418.89  147.43 &lt; 2.2e-16 ***
## Residuals 240 681.90    2.84                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="build-the-model" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> <strong>Build the model </strong></h2>
<div id="glm" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> GLM</h3>
<p>Advantages of GLMs over traditional regression<br />
- We do not need to transform the response Y to have a normal distribution<br />
- The choice of link is separate from the choice of random component thus we have more flexibility in modeling<br />
- If the link produces additive effects, then we do not need constant variance.<br />
- The models are fitted via Maximum Likelihood estimation; thus optimal properties of the estimators.<br />
- All the inference tools and model checking that we will discuss for log-linear and logistic regression models apply for other GLMs too; e.g., Wald and Likelihood ratio tests, Deviance, Residuals, Confidence intervals, Overdispersion.<br />
- There is often one procedure in a software package to capture all the models listed above, e.g. PROC GENMOD in SAS or glm() in R, etc… with options to vary the three components.</p>
</div>
<div id="but-there-are-some-limitations-of-glms-too-such-as" class="section level3" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> But there are some limitations of GLMs too, such as,</h3>
<ul>
<li>Linear function, e.g. can have only a linear predictor in the systematic component<br />
</li>
<li>Responses must be independent</li>
</ul>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="introduction-to-linear-models-in-r.html#cb198-1" aria-hidden="true"></a><span class="kw">hist</span>(koala<span class="op">$</span>size)</span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="introduction-to-linear-models-in-r.html#cb199-1" aria-hidden="true"></a><span class="kw">hist</span>(<span class="kw">log</span>(koala<span class="op">$</span>size))</span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="introduction-to-linear-models-in-r.html#cb200-1" aria-hidden="true"></a><span class="kw">hist</span>(koala<span class="op">$</span>weight)</span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="introduction-to-linear-models-in-r.html#cb201-1" aria-hidden="true"></a><span class="kw">hist</span>(<span class="kw">log</span>(koala<span class="op">$</span>weight))</span></code></pre></div>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-7-4.png" width="672" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="introduction-to-linear-models-in-r.html#cb202-1" aria-hidden="true"></a><span class="kw">summary</span>(koala<span class="op">$</span>size)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   64.81   68.43   70.27   70.94   72.33   81.91</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="introduction-to-linear-models-in-r.html#cb204-1" aria-hidden="true"></a>weight_sizemodel&lt;-<span class="kw">glm</span>(<span class="kw">log</span>(weight)<span class="op">~</span>size,<span class="dt">family=</span><span class="kw">gaussian</span>(<span class="dt">link=</span><span class="st">&#39;identity&#39;</span>),<span class="dt">data=</span>koala)</span>
<span id="cb204-2"><a href="introduction-to-linear-models-in-r.html#cb204-2" aria-hidden="true"></a><span class="kw">summary</span>(weight_sizemodel)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = log(weight) ~ size, family = gaussian(link = &quot;identity&quot;), 
##     data = koala)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.38285  -0.13252  -0.02833   0.09998   0.70169  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.054962   0.225778   0.243    0.808    
## size        0.028017   0.003178   8.816 2.47e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.0369023)
## 
##     Null deviance: 11.7246  on 241  degrees of freedom
## Residual deviance:  8.8566  on 240  degrees of freedom
## AIC: -107.72
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="introduction-to-linear-models-in-r.html#cb206-1" aria-hidden="true"></a><span class="kw">anova</span>(weight_sizemodel)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: gaussian, link: identity
## 
## Response: log(weight)
## 
## Terms added sequentially (first to last)
## 
## 
##      Df Deviance Resid. Df Resid. Dev
## NULL                   241    11.7246
## size  1    2.868       240     8.8566</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="introduction-to-linear-models-in-r.html#cb208-1" aria-hidden="true"></a><span class="kw">check_model</span>(weight_sizemodel, <span class="dt">check=</span><span class="kw">c</span>(<span class="st">&quot;qq&quot;</span>, <span class="st">&quot;normality&quot;</span>, <span class="st">&quot;ncv&quot;</span>, <span class="st">&quot;outliers&quot;</span>)) </span></code></pre></div>
<pre><code>## Not enough model terms in the conditional part of the model to check for multicollinearity.</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-7-5.png" width="672" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="introduction-to-linear-models-in-r.html#cb212-1" aria-hidden="true"></a><span class="kw">confint</span>(weight_sizemodel)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                   2.5 %     97.5 %
## (Intercept) -0.38755522 0.49747923
## size         0.02178785 0.03424534</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="introduction-to-linear-models-in-r.html#cb215-1" aria-hidden="true"></a>prediction_matrix &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(<span class="dt">size =</span> <span class="dv">60</span><span class="op">:</span><span class="dv">90</span>)</span>
<span id="cb215-2"><a href="introduction-to-linear-models-in-r.html#cb215-2" aria-hidden="true"></a>prediction_matrix<span class="op">$</span>lp &lt;-<span class="st"> </span><span class="fl">0.054962</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.028017</span> <span class="op">*</span><span class="st"> </span>prediction_matrix<span class="op">$</span>size</span>
<span id="cb215-3"><a href="introduction-to-linear-models-in-r.html#cb215-3" aria-hidden="true"></a>prediction_matrix<span class="op">$</span>mu &lt;-<span class="st"> </span><span class="kw">exp</span>(prediction_matrix<span class="op">$</span>lp)</span>
<span id="cb215-4"><a href="introduction-to-linear-models-in-r.html#cb215-4" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> koala, <span class="kw">aes</span>(<span class="dt">x =</span> size, <span class="dt">y =</span>weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;glm&quot;</span>)<span class="op">+</span></span>
<span id="cb215-5"><a href="introduction-to-linear-models-in-r.html#cb215-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> prediction_matrix, <span class="kw">aes</span>(size, mu))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="05-modeling_lm_files/figure-html/unnamed-chunk-7-6.png" width="672" /></p>
<p>😸</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-data-visualization-in-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
